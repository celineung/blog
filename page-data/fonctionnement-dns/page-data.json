{"componentChunkName":"component---src-templates-post-js","path":"/fonctionnement-dns","result":{"data":{"markdownRemark":{"html":"<p>Durant notre vie de développeur web, nous entendons forcément parler de DNS.\nNous savons qu'il se passe des choses derrière notre ordinateur lorsque nous requêtons <a href=\"https://google.fr\">https://google.fr</a> qui nous permettent d'accéder à notre page web. Pourtant, toute cette tambouille est cachée à nos yeux et nous pouvons accéder à <a href=\"https://google.fr\">https://google.fr</a> sans problème. Alors pourquoi s'y intéresser ? </p>\n<p>En tant que développeur, il arrive que nous ayons besoin de créer de nouveaux noms de domaines, ou d'en modifier. Certaines problématiques de réseaux peuvent survenir alors: URL web non accessible, un changement DNS non pris en compte... Connaître le fonctionnement du DNS peut nous aider à identifier ce qui pose problème dans le réseau.</p>\n<h2>DNS lookup de bout-en-bout</h2>\n<p>Examinons ensemble ce qu'il se passe lorsque nous requêtons une page, <a href=\"https://google.fr\">https://google.fr</a> par exemple. Dans ce cas, le nom de domaine est \"google.fr\".</p>\n<ol>\n<li>\n<p>Après avoir tapé l'url dans le <strong>navigateur</strong>, celui-ci va chercher dans son cache s'il connaît l'adresse IP associé à ce nom de domain. S'il ne la connaît pas, il va alors interroger le <strong>système d'exploitation</strong>. Si aucun des deux ne connait, alors le <strong>resolver DNS</strong> de notre fournisseur d'accès internet sera interrogé.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/0b9f44dda3336a325cf847ba6272f744/3d68f/dns_explained_local.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVQ4y42Si26DMAxF+f+PnKZqkxi0PBLivHNns2ajQKtZshJwcmJfuwFbKQXbtVp/83A+n8aeWSMHq4s559gtjLEMdDAUBAcJb8/t97/ALV0CWus71GNWCnpZkHN+gJzB6trk/BcMISKltO5jihiG4QG2t9MM297h8kl4/yB0XOKkHGfJJXOmIcafw5uL8mBMGdkp5KU7lN8kzjDGzF7gfcA4KQRei/fsvDK0WggB8zyBrIXXV0TVHoHPuiXhzIDMl8u9bNG2Fkdk1u8DcC/0QXTOMBnD4Alx+kSaLvwzYRjHA1C8eSb0w54BRX8BSwvfv4HMsupbG7htzmnJ+yxFWz1e2XuGWQQeJdxl2N9pXk19BcroJO7s2t0iHWYtgzTOgQaCapfzwX4F3Zs8kHgS7EzQN1ofEgn+leFZw4gsZp7Vvr+h6648bvP67xtwtAJG9NVNDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Recherche de l&#39;IP localement\"\n        title=\"Recherche de l&#39;IP localement\"\n        src=\"/blog/static/0b9f44dda3336a325cf847ba6272f744/fcda8/dns_explained_local.png\"\n        srcset=\"/blog/static/0b9f44dda3336a325cf847ba6272f744/12f09/dns_explained_local.png 148w,\n/blog/static/0b9f44dda3336a325cf847ba6272f744/e4a3f/dns_explained_local.png 295w,\n/blog/static/0b9f44dda3336a325cf847ba6272f744/fcda8/dns_explained_local.png 590w,\n/blog/static/0b9f44dda3336a325cf847ba6272f744/efc66/dns_explained_local.png 885w,\n/blog/static/0b9f44dda3336a325cf847ba6272f744/c83ae/dns_explained_local.png 1180w,\n/blog/static/0b9f44dda3336a325cf847ba6272f744/3d68f/dns_explained_local.png 2282w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p>Le resolveur DNS interroge alors son cache. S'il ne connait pas l'adresse IP associé au domaine, il va s'adresser à des serveurs DNS racines (appelés \"root\" en anglais).</p>\n<blockquote>\n<p>Les éléments mis dans le cache possèdent des TTL (time to live) qui indiquent pendant combien de temps ils sont valides. Passé ce délais, il faudra mettre à jour ces entrées du cache.</p>\n</blockquote>\n</li>\n<li>\n<p>Si <strong>serveur DNS root</strong> connaît l'adresse IP associé au nom de domaine google.fr, il le communiquera au résolveur qui remontera ensuite l'information à l'OS puis au navigateur. </p>\n<p>Dans le cas contraire, si le serveur DNS root connait l'adresse du serveur TLD .FR, il renverra cette adresse au résolveur, sinon le résolveur s'adressera à un autre serveur root.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/11ad2ae25cf446a113e090276d8d5e5f/59083/dns_explained_root.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.86486486486486%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQ4y51T266DIBD0/3+yfWhyHoyAFy4FZLqLQtoerE03Iay4M87uYIcvI6VU95JzqNsELexeBHRnwNbiWNc1L60snL5jTdtzd6bo5WzfY4xYtIYaRwghMQwC8zzDOXesMKuggtVaRAJzTkzwy4JRKXjvm5gmYW2LyAKBgxC4DwMM5caY5jxL3v2bUXn59JFIxJ4UBlL4adZNhU+I3KabJkhSd7lea5tHjmfCppO7Ki0lIjnnQ0Df99mMI6JKyEXlCpQV47anL91/IWQghzQWNzVtZjSG/W7AOeGi8SdHJFbG89vPP7XXJORinpOUKl9SY2z9E34iLMD3Of1K+ABvHgVNvrG9YgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Requêter le DNS racine\"\n        title=\"Requêter le DNS racine\"\n        src=\"/blog/static/11ad2ae25cf446a113e090276d8d5e5f/fcda8/dns_explained_root.png\"\n        srcset=\"/blog/static/11ad2ae25cf446a113e090276d8d5e5f/12f09/dns_explained_root.png 148w,\n/blog/static/11ad2ae25cf446a113e090276d8d5e5f/e4a3f/dns_explained_root.png 295w,\n/blog/static/11ad2ae25cf446a113e090276d8d5e5f/fcda8/dns_explained_root.png 590w,\n/blog/static/11ad2ae25cf446a113e090276d8d5e5f/efc66/dns_explained_root.png 885w,\n/blog/static/11ad2ae25cf446a113e090276d8d5e5f/c83ae/dns_explained_root.png 1180w,\n/blog/static/11ad2ae25cf446a113e090276d8d5e5f/59083/dns_explained_root.png 2331w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Il existe 13 serveurs root dans le monde, nommé A, B, C... à M. Chaque serveur root est associé à une adresse: a.root-servers.net, b.root-servers.net, c.root-servers.net, etc. Ils sont au sommet de la hiérarchie DNS. À eux 13, ils connaissent tous les IP associés aux noms de domaine. Chaque serveur root est distribué à plusieurs endroits dans le monde, pour éviter d'avoir un seul serveur physique.</p>\n<blockquote>\n<p>Comment le résolveur trouve-t-il le serveur root ? Chaque résolveur DNS connait à son démarrage l'adresse des 13 serveurs root. Lors d'un lookup DNS, le résolveur commence par requêter le premier serveur root de la liste (k.root-servers.net par exemple). Si celui-ci n'est pas disponible ou ne possède pas l'information recherché, le serveur root suivant est requêté (f.root-servers.net par exemple).</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/35bb650012846adb8277525145f708f7/63208/dns_explained_root_server.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.21621621621622%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA70lEQVQoz41R2w6DIAz1/39vr+qDGhxZFBTxrh2nGyTDmKxJ0wu9nB4S+lPO82S7Hyc9hKRp237yXpK4AfZOIcu6UvFqyIzjpZ4HxoPuFnhfdx0ppahtFe37fqlNYtirQ2CtpdEh8HaaJprnmZZlYWuMCbkYQEC4OU5QJKV021v2IWhCXNc1547jYGR933OuaZowOCBksl2RtSNprRnB9iUdxWh6PiXnveAdMRRLwqfgDOgwDO68DyoU4HTkscRzBR8U4M0v9L2gB34CRFmWsXaOcMAGqrIsKU1TyvOch0BwJuKiKAJaDBJCUFVVfN0b8VRxPW1s+ZcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Hiérarchie des serveurs DNS et TDL\"\n        title=\"Hiérarchie des serveurs DNS et TDL\"\n        src=\"/blog/static/35bb650012846adb8277525145f708f7/fcda8/dns_explained_root_server.png\"\n        srcset=\"/blog/static/35bb650012846adb8277525145f708f7/12f09/dns_explained_root_server.png 148w,\n/blog/static/35bb650012846adb8277525145f708f7/e4a3f/dns_explained_root_server.png 295w,\n/blog/static/35bb650012846adb8277525145f708f7/fcda8/dns_explained_root_server.png 590w,\n/blog/static/35bb650012846adb8277525145f708f7/efc66/dns_explained_root_server.png 885w,\n/blog/static/35bb650012846adb8277525145f708f7/c83ae/dns_explained_root_server.png 1180w,\n/blog/static/35bb650012846adb8277525145f708f7/63208/dns_explained_root_server.png 2105w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p>Le <strong>serveur TLD</strong> regardera ce que l'on appelle le nom de domaine de premier niveau (Top Level Domain), qui est \".FR\" dans notre exemple. Il provient du nom de domaine \"google.fr\". </p>\n<p>Le serveur TLD redirigera ensuite le résolveur vers les serveurs de noms faisant authorité (Authoritative Name Server). Dans notre exemple, il s'agit de :</p>\n<ul>\n<li>ns1.google.com</li>\n<li>ns2.google.com</li>\n<li>ns3.google.com</li>\n<li>ns4.google.com.</li>\n</ul>\n</li>\n<li>Le résolveur requêtera alors un à un les Authoritative Name Servers ci-dessus jusqu'à trouver celui qui connaît l'adresse IP de google.fr.</li>\n<li>Une fois l'IP trouvée, le résolveur la stocke dans son cache. L'information est transmise à l'OS puis au navigateur qui enregistre aussi l'IP dans leur cache.</li>\n</ol>\n<br>\n<p>Le schéma de fonctionnement obtenu devient:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/d15a9e1a30fa99182aedfe968a346ee4/0f729/dns_explained_global.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVQ4y4VUa2/CMAzs//9vfEZC4tOGkPoaTdrm3dvZtIzCpkUKNbF955zdVsCCbeWcIf+nOcH5pPayupfV+In+fVUSKLHynOcZIQQMxmKa5jWEzpJ/QDV+2ZHsAOVnnDPq1uPjMmC0DtM4arDzASl6ZG93lf4LWOhIqcD7iJISFla6pIDoLJxzGKfpDeAvu3pjKQU5RHjTIpkaMwFFhoc7FpIuu2qfd/XqkBVjQtO2CNRxiVHPRN9Ie7IzzGDhSfKap4C/sTx6yWoX75BcpJYJ1hpKk5B5Xrif1wZa/dV+SRD9nPcYestmTRynmTrfKxO/VCxyyFNGTp5aYeFhZrBstemIEkgtDUfoNgy43W687ojERGmiaHu5XHA8HnE6ndA0jcpyByRAYkL6+kI0BpFVbVfIq4Z6Lek+iQr9gXZd1wrUdR36vr8DbtMvANZadHTolVmB//xEIMnIuTQkKlKdkLPizNjXpU2RuZMtlQigsCqgXJnMAnw+n3E4HLQC9a05+hJJ4546XckVRmpV9lSP9zbTLyMi4muynBMsxQAT3ds8ViLutW7QdL2OxO5DkO+dbCazO5e4nppf24ZEcT+H4tT2c2+z9WDUgXYk67TKbUmOjpTovA74lvcNlzKaxLonjBwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"résumé du fonctionnement global du DNS\"\n        title=\"résumé du fonctionnement global du DNS\"\n        src=\"/blog/static/d15a9e1a30fa99182aedfe968a346ee4/fcda8/dns_explained_global.png\"\n        srcset=\"/blog/static/d15a9e1a30fa99182aedfe968a346ee4/12f09/dns_explained_global.png 148w,\n/blog/static/d15a9e1a30fa99182aedfe968a346ee4/e4a3f/dns_explained_global.png 295w,\n/blog/static/d15a9e1a30fa99182aedfe968a346ee4/fcda8/dns_explained_global.png 590w,\n/blog/static/d15a9e1a30fa99182aedfe968a346ee4/efc66/dns_explained_global.png 885w,\n/blog/static/d15a9e1a30fa99182aedfe968a346ee4/c83ae/dns_explained_global.png 1180w,\n/blog/static/d15a9e1a30fa99182aedfe968a346ee4/0f729/dns_explained_global.png 4381w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Exécuter une requête DNS</h2>\n<p>Le cheminement suivi lors du lookup DNS peut-être examiné avec la commande <code class=\"language-text\">dig +trace</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">&gt; dig +trace google.fr\n.\t\t\t488309\tIN\tNS\tb.root-servers.net.\nfr.\t\t\t172800\tIN\tNS\td.nic.fr.\ngoogle.fr.\t\t172800\tIN\tNS\tns3.google.com.\ngoogle.fr.\t\t300\tIN\tA\t142.250.179.99</code></pre></div>\n<p>La première ligne retourné correspond à la requête vers le serveur DNS root \"b.root-servers.net\".</p>\n<p>La 2e ligne correspond à la requête vers le serveur TLD, et finalement la 3e ligne est celle vers le Authoritative Name Server. </p>\n<p>On obtient finalement l'IP de google.fr ! </p>\n<h2>Propagation DNS explained !</h2>\n<p>Lorsque l'on modifie le DNS pour qu'un nom de domaine pointe sur une autre adresse IP, la modification n'est pas immédiatement visible sur navigateur: c'est la propagation DNS !</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Domain</th>\n<th>IP</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>avant modification</td>\n<td>exemple.fr</td>\n<td>104.28.5.98</td>\n</tr>\n<tr>\n<td>après modification</td>\n<td>exemple.fr</td>\n<td>132.30.160.99</td>\n</tr>\n</tbody>\n</table>\n<p>La propagation DNS est le délais nécessaire pour que les différents serveurs mettent à jour leur cache. </p>\n<h2>TLDR</h2>\n<p>Pour résumer: pour récupérer une page web \"<a href=\"https://google.fr%22\">https://google.fr\"</a>, nous avons besoin de connaître l'adresse IP associé au nom de domaine \"google.fr\".</p>\n<p>Pour cela:</p>\n<ul>\n<li>le navigateur va passer par le système d'exploitation de l'ordinateur puis le résolveur DNS du fournisseur internet.</li>\n</ul>\n<p>Si aucun de ces deux éléments n'a l'adresse IP, alors on va décomposer le nom de domaine google.fr:</p>\n<ul>\n<li>on interroge en root serveur en premier pour savoir où trouver le serveur TLD qui connaît \".FR\"</li>\n<li>on interroge ce serveur TLD \".FR\" pour connaître le serveur de nom faisant autorité qui connait \"google.fr\"</li>\n<li>le serveur de nom faisant autorité nous donne l'adresse IP de \"google.fr\"</li>\n</ul>","excerpt":"Durant notre vie de développeur web, nous entendons forcément parler de DNS. \nNous savons qu'il se passe des choses derrière notre…","frontmatter":{"date":"2021-04-24","slug":"fonctionnement-dns","title":"DNS: que se passe-t-il sous le capot de ma requête web ?","illustration":{"childImageSharp":{"resize":{"src":"/static/70ddd7862574df3273be2d0d3e3653a2/47498/desk-setup-with-motivational-poster.jpg","height":801,"width":1200}}}}}},"pageContext":{"slug":"fonctionnement-dns"}},"staticQueryHashes":["3649515864","764694655"]}